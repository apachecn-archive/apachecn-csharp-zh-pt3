# 二十八、对设计模式的批评

设计模式让你受益于他人的经验，这通常被称为*经验重用*。你学习他们如何解决问题，他们如何试图在他们的系统中采用新的行为，等等。一个模式可能并不完全适合你的工作，但是如果你在开始的时候专注于最佳实践以及模式的问题，你就更有可能做出更好的应用。这就是为什么我现在将讨论设计模式的批评。了解他们可以为你提供一些真正的价值。如果你在设计软件之前批判性地思考模式，你可以在某种程度上预测你的投资回报。让我们回顾一下一些开发人员经常提出的以下几点:

*   模式的概念来自克里斯托弗·亚历山大。他是一名建筑师，但不是计算机程序员。他考虑了多年来变化不大的领域(与软件行业相比)。相反，软件行业总是在变化，软件开发的变化比任何其他领域都要快。这就是为什么批评家经常说你不能从克里斯托弗·亚历山大考虑过的领域(建筑和城镇)出发。

*   与今天相比，你在编程早期编写程序的方式是非常不同的。与早期的编程相比，现在你享受到了更多的便利(例如，更大的存储空间，超快的计算能力等)。因此，当您基于旧的实践提取模式时，您对它们表现出额外的尊重。

*   许多模式都是相似的，每种模式都有利弊。(我在每章末尾的“问答环节”中讨论了它们。)一种情况下的缺点在另一种情况下可能是真正的优点。

*   由于软件行业的不断变化，今天给你带来满意结果的模式将来可能会成为你的一个大负担。

*   用有限数量的设计模式很难很好地设计出无限数量的需求。

*   设计软件是一门艺术。对于最好的艺术没有定义或标准。

*   设计模式给你的是想法，而不是实现(比如库和框架)。你知道每个人的思想都是独一无二的。因此，每个工程师可能对实现类似的概念有自己的偏好，如果心态差异很大，这可能会在团队中造成混乱。

*   考虑一个简单的例子。模式鼓励人们编写超类型(抽象类/接口)的代码。但是对于一个简单的应用，您知道没有即将到来的变化，或者应用只是为了演示的目的而创建的，这个想法可能对您没有太大的意义。

*   类似地，在一些较小的应用中，您可能会发现强制执行设计模式的规则会增加您的代码大小和维护成本。

*   抹去旧的，接受新的并不总是容易的。例如，当你第一次了解到遗传时，你很兴奋。你可能想以多种方式使用它，并且只看到这个概念的好处。但是后来，当您开始尝试设计模式时，您开始了解到在许多情况下，组合比继承更受欢迎。这种编程心态的转变并不容易。

*   设计模式基于一些关键原则，其中之一是*识别可能变化的代码，然后将其从代码的其余部分中分离出来*。从理论角度听起来很不错。但是在现实世界的实现中，谁能保证你的判断是完美的呢？软件行业总是在变化，它需要不断适应新的需求。

*   许多模式已经集成到现代语言中。您可以使用语言构造中的内置支持，而不是从头开始实现模式。

*   不恰当地使用模式会导致反模式(例如，不恰当地使用中介模式会导致 God 类反模式)。我在第 29 章中提供了反模式的概述。

*   许多人认为设计模式的概念只是表明一种编程语言可能需要一些额外的特性。因此，随着现代编程语言能力的提高，模式变得不那么重要。维基百科说，计算机科学家 Peter Norvig 认为，GoF 设计模式中的 23 种模式中有 16 种通过 Lisp 或 Dylan 的直接语言支持被简化或消除。你可以在 [`https://en.wikipedia.org/wiki/Software_design_pattern`](https://en.wikipedia.org/wiki/Software_design_pattern) 看到类似的想法。

*   我在本书中讨论的模式完全基于面向对象编程。这些模式的效率和适用性在其他领域是有问题的。

*   这些模式不可互换。

*   最后，设计模式帮助你从他人的经验中获益。你了解他们的想法；您开始了解他们是如何遇到挑战的，他们是如何在他们的系统中实现新行为的，等等。但是，如果你深入到基本思想，你会发现你开始的假设是，一个初学者或相对缺乏经验的人不能比他/她的前辈更好地解决问题。有时候，一个相对缺乏经验的人比他的前辈有更好的眼光，他证明自己更有效。

## 问答环节

有这些模式的目录吗？

我从 GoF 的 23 种设计模式开始，然后在本书中讨论了更多的模式。GoF 的目录被认为是最基本的模式目录。

许多其他目录侧重于域。波特兰模式库和希尔赛德集团的网站在这方面是众所周知的。你可以从这些资源中获得有价值的见解和想法。希尔赛德集团网站还提供了各种会议和研讨会的信息。

作为起点，你可以参观 [`https://wiki.c2.com/?PortlandPatternRepository`](https://wiki.c2.com/%253FPortlandPatternRepository) 和 [`https://hillside.net/patterns/patterns-catalog`](https://hillside.net/patterns/patterns-catalog) 。

Note

在撰写本文时，本书中提到的 URL 运行良好，但它们可能会在未来发生变化。

28.2 你为什么对其他模式保持沉默？

这些是我个人的信念。

*   计算机科学会不断发展，你会不断得到新的模式。

*   如果您不熟悉基本模式，您就不能评估剩余的或即将到来的模式的真正需求。比如你很了解 MVC，你就能看出它和模型-视图-展示者(MVP)有什么不同，明白为什么需要 MVP。

*   这本书已经很大了。对每个模式更详细的讨论需要更多的页面，这将使本书太大而难以消化。

因此，在这本书里，我把重点放在在今天的编程世界中仍然相关的基本模式上。

**28.3 我经常看到** ***力*** **这个词与设计模式的描述。这是什么意思？**

这是开发人员证明其开发合理性的标准。概括地说，你的目标和当前的约束是你的力量的两个重要部分。因此，当您开发您的应用时，您可以用这些部分来证明您的开发。

在各种论坛上，我看到人们在为模式的定义争论不休，并且说“模式是在一个环境中对一个问题的一个被证明的解决方案。”这是什么意思？

这是一个简单易记的模式定义。但是简单地把它分成三个部分(问题、背景和解决方案)是不够的。

比如你在去机场的路上，你很着急。突然，你意识到你把登机牌落在家里了。我们来分析一下情况。

**问题**:你需要准时到达机场。

背景:你把登机牌落在家里了。

**你可能想到的解决办法**就是折返，赶回家拿登机牌。

这个解决方案可能只工作一次，但是你能重复应用同样的程序吗？你知道答案。这不是一个明智的解决方案，因为它取决于你目前有多少时间回家拿登机牌，然后到达机场。还要看现在的流量等很多因素。所以，即使你成功了一次，你也要为将来类似的情况准备更好的解决方案。

努力学习意思、意图、上下文等等，以便清楚地理解一个模式。

当我看到两种不同模式的相似 UML 图时，我感到困惑。此外，在许多情况下，我还对模式的分类感到困惑。

这是非常自然的。您越是阅读和分析这些实现，越是试图理解这些设计背后的意图，它们之间的区别就会变得越清晰。

我应该什么时候考虑写一个新的模式？

写一个新的模式并不容易。您需要研究和评估可用的模式。但是如果您找不到现有的模式来满足您特定领域的需求，您可能需要编写自己的模式。如果您的解决方案通过了三个的**规则，这是最好的，该规则说，要实现一个标签模式，一个解决方案需要在现实世界的解决方案中成功应用至少三次。一旦你做到了这一点，你就可以让其他人知道它，参与讨论论坛，并从其他人那里得到反馈。这项活动对您和开发社区都有帮助。**